<Window x:Class="KursovoiTuv.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        Title="Портал заказов - МеталлФэмили Инжиниринг"
        Height="750"
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F7FA">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- Цветовая схема -->
        <SolidColorBrush x:Key="PrimaryColor" Color="#2C3E50"/>
        <SolidColorBrush x:Key="AccentColor" Color="#3498DB"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#27AE60"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F39C12"/>
        <SolidColorBrush x:Key="DangerColor" Color="#E74C3C"/>
        <SolidColorBrush x:Key="LightBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BorderColor" Color="#E1E8ED"/>

        <!-- Стили кнопок -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentColor}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#ECF0F1"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
        </Style>

        <!-- Стиль GroupBox -->
        <Style TargetType="GroupBox">
            <Setter Property="Background" Value="{StaticResource LightBackground}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryColor}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Стиль TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Margin" Value="4"/>
        </Style>

        <!-- Стиль ComboBox -->
        <Style TargetType="ComboBox">
            <Setter Property="Padding" Value="6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Margin" Value="4"/>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryColor}" 
                Margin="0,0,0,15" Padding="15">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left">
                    <TextBlock Text="ПОРТАЛ ЗАКАЗОВ" 
                               FontSize="20" FontWeight="Bold" 
                               Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock Text="МеталлФэмили Инжиниринг" 
                               FontSize="14" Foreground="#BDC3C7" 
                               Margin="0,2,0,0"/>
                </StackPanel>

                <Menu DockPanel.Dock="Right" Background="Transparent" 
                      Foreground="White">
                    <MenuItem Header="Справка">
                        <MenuItem Header="О программе" 
                                  Command="{Binding OpenAboutCommand}"/>
                    </MenuItem>
                </Menu>
            </DockPanel>
        </Border>

        <!-- Основной контент -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Левая панель: Управление заказами -->
            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                <!-- Панель добавления/редактирования -->
                <GroupBox Header="{Binding EditModeTitle}" FontSize="14">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Основные поля -->
                        <Grid Grid.Row="0" Margin="0,0,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox Grid.Column="0" 
                                     Text="{Binding CurrentOrder.ClientName, UpdateSourceTrigger=PropertyChanged}" 
                                     ToolTip="Клиент" Height="36"/>
                            <TextBox Grid.Column="1" 
                                     Text="{Binding CurrentOrder.ProductDescription, UpdateSourceTrigger=PropertyChanged}" 
                                     ToolTip="Изделие" Height="36"/>
                            <TextBox Grid.Column="2" 
                                     Text="{Binding CurrentOrder.Quantity, UpdateSourceTrigger=PropertyChanged}" 
                                     ToolTip="Количество" Height="36"/>
                            <ComboBox Grid.Column="3" 
                                     SelectedValue="{Binding CurrentOrder.Priority}"
                                     Margin="4" Height="36" ToolTip="Приоритет">
                                <System:String>Высокий</System:String>
                                <System:String>Средний</System:String>
                                <System:String>Низкий</System:String>
                            </ComboBox>

                            <StackPanel Grid.Column="4" Orientation="Horizontal" 
                                        VerticalAlignment="Center">
                                <!-- Кнопка Добавить -->
                                <Button x:Name="AddButton" Content="Добавить" 
                                        Command="{Binding AddOrderCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Background="{StaticResource SuccessColor}">
                                </Button>

                                <!-- Кнопки редактирования -->
                                <Button Content="Сохранить" 
                                        Command="{Binding UpdateOrderCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Background="{StaticResource SuccessColor}"
                                        Visibility="{Binding IsEditing, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <Button Content="Отмена" 
                                        Command="{Binding CancelEditCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Visibility="{Binding IsEditing, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            </StackPanel>
                        </Grid>

                        <!-- Дополнительные поля редактирования -->
                        <Border Grid.Row="1" 
                                Visibility="{Binding IsEditing, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Background="#F8F9FA" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <DatePicker Grid.Column="0" 
                                           SelectedDate="{Binding CurrentOrder.Deadline}"
                                           Margin="4" Height="36" ToolTip="Срок выполнения"/>
                                <ComboBox Grid.Column="1" 
                                         SelectedValue="{Binding CurrentOrder.Status}"
                                         Margin="4" Height="36" ToolTip="Статус">
                                    <System:String>Новый</System:String>
                                    <System:String>В работе</System:String>
                                    <System:String>На проверке</System:String>
                                    <System:String>Завершен</System:String>
                                </ComboBox>
                                <Border Grid.Column="2" Background="White" 
                                        BorderThickness="1" 
                                        BorderBrush="{StaticResource BorderColor}" 
                                        Margin="4" Padding="8">
                                    <TextBlock Text="{Binding CurrentOrder.OrderNumber, StringFormat='Номер: {0}'}"
                                              VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Column="3" Background="White" 
                                        BorderThickness="1" 
                                        BorderBrush="{StaticResource BorderColor}" 
                                        Margin="4" Padding="8">
                                    <TextBlock Text="{Binding CurrentOrder.OrderDate, StringFormat='Создан: {0}'}"
                                              VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </GroupBox>

                <!-- Список заказов -->
                <GroupBox Header="Заказы в работе" FontSize="14">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <DataGrid Grid.Row="0" ItemsSource="{Binding Orders}" 
                                  SelectedItem="{Binding SelectedOrder}"
                                  Margin="5" Height="320"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  Background="White"
                                  BorderBrush="{StaticResource BorderColor}"
                                  BorderThickness="1">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="№" Binding="{Binding OrderNumber}" 
                                                    Width="80" FontWeight="SemiBold"/>
                                <DataGridTextColumn Header="Клиент" Binding="{Binding ClientName}" 
                                                    Width="150"/>
                                <DataGridTextColumn Header="Изделие" Binding="{Binding ProductDescription}" 
                                                    Width="220"/>
                                <DataGridTextColumn Header="Кол-во" Binding="{Binding Quantity}" 
                                                    Width="70"/>
                                <DataGridTextColumn Header="Срок" 
                                                    Binding="{Binding Deadline}" 
                                                    Width="85"/>
                                <DataGridTextColumn Header="Статус" Binding="{Binding Status}" 
                                                    Width="100"/>
                                <DataGridTextColumn Header="Приоритет" Binding="{Binding Priority}" 
                                                    Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- Панель действий -->
                        <Border Grid.Row="1" Background="#F8F9FA" 
                                Margin="5" Padding="8">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button Content="Редактировать" 
                                        Command="{Binding EditOrderCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        ToolTip="Редактировать выбранный заказ"/>
                                <Button Content="Удалить" 
                                        Command="{Binding DeleteOrderCommand}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Background="{StaticResource DangerColor}"
                                        ToolTip="Удалить выбранный заказ"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </GroupBox>
            </StackPanel>

            <!-- Правая панель: Детали заказа -->
            <GroupBox Grid.Column="1" Header="Детали заказа" FontSize="14">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="5" DataContext="{Binding SelectedOrder}">
                        <!-- Заголовок деталей -->
                        <Border Background="{StaticResource AccentColor}" 
                                Padding="10" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="№ заказа" Foreground="White" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding OrderNumber}" 
                                           Foreground="White" FontSize="20" 
                                           FontWeight="Bold"/>
                            </StackPanel>
                        </Border>

                        <!-- Информация о заказе -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock Text="ОСНОВНАЯ ИНФОРМАЦИЯ" 
                                       FontWeight="Bold" FontSize="12"
                                       Foreground="{StaticResource PrimaryColor}"
                                       Margin="0,0,0,10"/>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="Клиент:" 
                                           Foreground="#7F8C8D" FontSize="12"/>
                                <TextBlock Grid.Row="1" Text="{Binding ClientName}" 
                                           FontWeight="SemiBold" Margin="0,2,0,10"/>

                                <TextBlock Grid.Row="2" Text="Изделие:" 
                                           Foreground="#7F8C8D" FontSize="12"/>
                                <TextBlock Grid.Row="3" Text="{Binding ProductDescription}" 
                                           FontWeight="SemiBold" Margin="0,2,0,10"/>

                                <TextBlock Grid.Row="4" Text="Количество:" 
                                           Foreground="#7F8C8D" FontSize="12"/>
                                <TextBlock Grid.Row="5" Text="{Binding Quantity}" 
                                           FontWeight="SemiBold" Margin="0,25,0,10"/>
                            </Grid>
                        </StackPanel>

                        <!-- Дополнительная информация -->
                        <StackPanel Margin="0,0,0,25">
                            <TextBlock Text="ДОПОЛНИТЕЛЬНО" 
                                       FontWeight="Bold" FontSize="12"
                                       Foreground="{StaticResource PrimaryColor}"
                                       Margin="0,0,0,10"/>

                            <Border Background="#F8F9FA" Padding="10">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Text="Срок выполнения:" 
                                               Foreground="#7F8C8D" FontSize="12"/>
                                    <TextBlock Grid.Row="1" 
                                               Text="{Binding Deadline}" 
                                               FontWeight="SemiBold" Margin="0,2,0,8"/>

                                    <TextBlock Grid.Row="2" Text="Стоимость:" 
                                               Foreground="#7F8C8D" FontSize="12"/>
                                    <TextBlock Grid.Row="3" 
                                               Text="{Binding Cost}" 
                                               FontWeight="SemiBold" Margin="0,2,0,8"
                                               Foreground="{StaticResource SuccessColor}"/>

                                    <TextBlock Grid.Row="4" Text="Статус:" 
                                               Foreground="#7F8C8D" FontSize="12"/>
                                    <TextBlock Grid.Row="5" 
                                               Text="{Binding Status}" 
                                               FontWeight="SemiBold" Margin="0,2,0,8"/>

                                    <TextBlock Grid.Row="6" Text="Приоритет:" 
                                               Foreground="#7F8C8D" FontSize="12"/>
                                    <TextBlock Grid.Row="7" 
                                               Text="{Binding Priority}" 
                                               FontWeight="SemiBold" Margin="0,2,0,8"/>
                                </Grid>
                            </Border>
                        </StackPanel>

                        <!-- Управление статусом -->
                        <StackPanel Margin="0,10,0,0">
                            <TextBlock Text="УПРАВЛЕНИЕ СТАТУСОМ" 
                                       FontWeight="Bold" FontSize="12"
                                       Foreground="{StaticResource PrimaryColor}"
                                       Margin="0,0,0,10"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="Предыдущий" 
                                        Command="{Binding DataContext.PreviousStatusCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Visibility="{Binding CanMovePrevious, Converter={StaticResource BooleanToVisibilityConverter}}"
                                        Width="120"/>

                                <Button Content="Следующий" 
                                        Command="{Binding DataContext.NextStatusCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Visibility="{Binding CanMoveNext, Converter={StaticResource BooleanToVisibilityConverter}}"
                                        Width="120"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
        </Grid>

        <!-- Статус бар -->
        <StatusBar Grid.Row="3" Margin="0,10,0,0" Background="{StaticResource PrimaryColor}" Foreground="White">
            <StatusBarItem>
                <TextBlock Text="{Binding Orders.Count, StringFormat='Всего заказов: {0}'}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="МеталлФэмили Инжиниринг 2025"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>